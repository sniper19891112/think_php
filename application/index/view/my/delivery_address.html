<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport"
        content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1,minimum-scale=1" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta content="telephone=yes" name="format-detection" />
    <meta name="apple-mobile-web-app-status-bar-style" content="white" />
    <meta name="x5-fullscreen" content="true" />
    <meta name="apple-touch-fullscreen" content="yes" />
    <title>{:lang('我的')}</title>
    <link rel="stylesheet" href="/statics/css/global.css" />
    <link rel="stylesheet" href="/web/css/delivery_address.css" />
    <link rel="stylesheet" href="/static_new/css/public.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined">
    <script charset="utf-8" src="/static_new/js/jquery.min.js"></script>
    <script charset="utf-8" src="/static_new/js/dialog.min.js"></script>
    <script charset="utf-8" src="/static_new/js/common.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
</head>

<body>
    <div id="app">
        <div class="delivery-header">
            <i class="material-icons-outlined" style="margin-right: 10px; cursor: pointer;" onclick="goBack()">
                arrow_back
            </i>
            Delivery Address
        </div>
        <div class="delivery-body">
            <div class="delivery-container">
                <div class="delivery-name-input-form">
                    <i class="material-icons-outlined" translate="no">
                        person
                    </i>
                    <input class="delivery-name-input" id="name" type="text" placeholder="Please enter the name" value="{$delivery.name}"/>
                </div>
                <div class="delivery-phone-input-form">
                    <i class="material-icons-outlined" translate="no">
                        call
                    </i>
                    <input class="delivery-phone-input" id="tel" type="text" placeholder="Please enter your phone number"  value="{$delivery.tel}"/>
                </div>
                <div class="delivery-address-input-form">
                    <i class="material-icons-outlined" translate="no">
                        location_on
                    </i>
                    <input class="delivery-address-input" id="address" type="text" placeholder="Please enter the address"  value="{$delivery.address}"/>
                </div>
            </div>
            <div style="margin-top: 48px;">
                <button class="submit-btn" onclick="submitDeliveryAddress()">submit</button>
            </div>
        </div>
    </div>
</body>
<script type="application/javascript">
    function goBack() {
        window.history.go(-1);
    }
    function submitDeliveryAddress() {
        if (!$("#name").val().trim()) {
            $(document).dialog({infoText: 'Please input name'});
            return;
        }
        if (!$("#tel").val().trim()) {
            $(document).dialog({infoText: 'Please input tel'});
            return;
        }
        if (!$("#address").val().trim()) {
            $(document).dialog({infoText: 'Please input address'});
            return;
        }
        $.ajax({
            url: "{:request()->url()}",
            type: "POST",
            dataType: "JSON",
            data: { name: $("#name").val(), tel: $("#tel").val(), address: $("#address").val()},
            success: function (res) {
                if (res.code == 0) {
                    $(document).dialog({ infoText: "success" });
                    setTimeout(() => {
                        location.href = "{:url('my/index')}"
                    }, 3000);
                } else {
                    $(document).dialog({ infoText: res.info });
                }
            },
            error: function (err) {
                $(document).dialog({ infoText: "error" });
            }
        })
    }
</script>

</html>